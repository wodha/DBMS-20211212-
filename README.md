# DBMS-20211212-


UNION
SELECT DEPTNO, JOB, UPPER(JOB), LOWER(JOB)
FROM EMP
WHERE DEPTNO = 20;

[LENGTH : 길이를 구하는 내장함수]
SELECT ENAME, LENGTH(ENAME)
FROM EMP;
문자열의 길이를 구할 때 사용한다.

[SUBSTR : 문자열 일부를 추출하는 내장함수]
-- SUBSTR(문자열 데이터, 시작위치, 추출길이)
-- SUBSTR(문자열 데이터, 시작위치)
SELECT 
JOB, 
SUBSTR(JOB, 1, 2), 
SUBSTR(JOB, 3, 2),
SUBSTR(JOB, 5)
FROM EMP;

[문제] 이름을 2~4로 자르는 열과 3~끝까지 자르는 열을 출력하시오. [ENMAE, ENAME(2,4), ENAME(3)]
SELECT
ENAME,
SUBSTR(ENAME, 2, 4),
SUBSTR(ENAME, 3)
FROM EMP;

[REPLACE : 특정 문자를 다른 문자로 바꾸는 내장함수]
-- REPLACE ([문자열 데이터 또는 열이름(필수)], [찾는 문자열(필수)], [대체할 문자열(선택)]
SELECT '010-1234-5678' AS REPLACE_BEFORE,
REPLACE('010-1234-5678', '-', ' ') AS REPLACE_1,
REPLACE('010-1234-5678', '-') AS REPLACE_2
FROM DUAL;

[복습] 위의 내용을 한번 다시 타이핑 해볼 것
SELECT '010-1234-5678' AS REPLACE_BEFORE,
REPLACE('010-1234-5678', '-', ' ') AS REPLACE_1,
REPLACE('010-1234-5678', '-') AS REPLACE_2
FROM DUAL;


[SYSDATE : 날짜 데이터를 다루는 날짜 함수]
SELECT SYSDATE AS NOW,
SYSDATE - 1 AS YESTERDAY,
SYSDATE + 1 AS TOMORROW
FROM DUAL;


[ADD_MONTHS : 특정일자를 기준으로 이후의 날짜를 구해주는 내장함수]
// 입사일 이후 120일이 지난 직원 출력
SELECT EMPNO, ENAME, HIREDATE, ADD_MONTHS(HIREDATE, 120) AS WORK10YEAR FROM EMP;

[문제] 입사일 이후 32년(384) 지난 직원을 출력
SELECT EMPNO, ENAME, HIREDATE, ADD_MONTHS(HIREDATE, 384) AS WORK32YEAR FROM EMP;
[문제] 입사일이 32년이 되지 않은 직원들을 출력하시오.
SELECT EMPNO, ENAME, HIREDATE, ADD_MONTHS(HIREDATE, 384) AS WORK32YEAR FROM EMP WHERE ADD_MONTHS(HIREDATE, 384) < MONTHS(HIREDATE, 384);

SELECT EMPNO, ENAME, HIREDATE, ADD_MONTHS(HIREDATE, 384) AS WORK32YEAR FROM EMP WHERE ADD_MONTHS(HIREDATE, 384) < SYSDATE;

[NVL : 데이터가 NULL이 아니면 그 데이터를 그대로 출력하고 NULL이면 사용자가 입력한 데이터를 출력하는 내장함수]
SELECT
ENAME, COMM, SAL + COMM AS MYMON, NVL(COMM, 0), SAL + NVL(COMM, 0)
FROM EMP;

SELECT
ENAME, COMM, SAL + COMM AS MYMON, NVL2(COMM, 'O', 'X')
FROM EMP;

** 집계함수
[SUM 함수 : 조건의 맞는 모든 열의 합]
SELECT SUM(SAL) FROM EMP;

[문제] 연봉(SAL * 12 + COMM)을 모두 합산하여 출력하시오.
SELECT SUM(SAL *12 + COMM) AS ANNSAL FROM EMP;

[COUNT 함수 : 조건에 맞는 행의 갯수를 구해준다.]
SELECT COUNT(*) FROM EMP;

[MAX최대값, MIN최솟값을 구하는 내장함수.]

SELECT MAX(SAL), MIN(SAL) FROM EMP;

[AVG : 평균값을 구하는 내장함수]
SELECT AVG(SAL) FROM EMP;

[GROUP BY : 결과 값을 원하는 기준의 그룹으로 묶어 출력]
SELECT DEPTNO, MAX(SAL)
FROM EMP
GROUP BY DEPTNO;

// 부서별 MAX SAL을 알고싶다.
SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 10;
SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 20;
SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 30;
-> 귀찮다. -> GROUP BY
SELECT DEPTNO, MAX(SAL) FROM EMP GROUP BY DEPTNO ORDER BY DEPTNO ASC;

[HAVING절 GROUP에 조건을 주고싶다.]
SELECT DEPTNO, JOB, AVG(SAL)
FROM EMP
GROUP BY DEPTNO, JOB
HAVING AVG(SAL) >= 2000;

** WHERE 절과의 차이점
WHERE절은 하나하나의 ROW에 대해 조건을 체크하지만
HAVING절은 전체 GROUPING한 결과에 대해서만 조건을 체크한다.

[문제] JOB그룹의 사원번호 평균을 3000 이상인 데이터만 출력하시오.
SELECT JOB, AVG(EMPNO)
FROM EMP
GROUP BY JOB
HAVING AVG(EMPNO) >= 3000;

(연습문제)
1. JOB이 CLERK인 데이터 조회
SELECT * FROM EMP WHERE JOB = 'CLERK';

2. SAL이 1000이상인 데이터 조회
SELECT * FROM EMP WHERE SAL >= 1000;

3. COMM이 NULL인 데이터만 조회
SELECT * FROM EMP WHERE COMM IS NULL;

4. COMM이 NULL이 아닌 데이터만 조회
SELECT * FROM EMP WHERE COMM IS NOT NULL;

5. 사원이름에서 'R'로 끝나는 데이터 조회
SELECT * FROM EMP WHERE ENAME LIKE '%R';

6. 사원이름이 'M'으로 시작하면서 부서번호가 30이 아닌 사람 조회
SELECT * FROM EMP WHERE ENAME LIKE 'M%' AND DEPTNO != 30;

7. 연봉이 1000~2000인 데이터 조회
SELECT * FROM EMP WHERE SAL BETWEEN 1000 AND 2000;

8. JOB이 CLERK인 사람을 내림차순으로 정렬
SELECT * FROM EMP WHERE JOB = 'CLERK' ORDER BY JOB DESC;

9. 연봉순 정렬 (오름차순)
SELECT SAL*12+COMM AS ANNSAL FROM EMP ORDER BY SAL*12+COMM ASC;

10. 부서 중복제거하여 출력하시오.
SELECT DISTINCT DNAME FROM DEPT;



MEMO
내장함수 : 오라클에서 기본적으로 제공해주는 함수

SELECT ENAME, SUBSTR(ENAME, 2, 4), SUBSTR(ENAME, 3) FROM EMP;
SELECT ENAME, LENGTH(ENAME) FROM EMP;
SELECT ENAME, UPPER(ENAME), LOWER(ENAME) FROM EMP;
